<https://www.jianshu.com/p/29e0ba31fb8d>

<https://www.jianshu.com/p/6c46ef63c407>

# HTTPS



## 问题

​	https在数据通信时，实际是采用**对称加密**，因为**非对称加密**传输效率相对较低，在大访问量不能满足。而对称加密双方都需要持有相同的key，那么在key的传输过程中，才使用非对称加密，并且是单方面的，由客户端通过服务端的公钥，加密key，传给服务端，服务端私钥解密后才得到key。

​	所以问题的关键在于：<u>*如何安全的获得服务的公钥。*</u>



## **非对称加密部分**



### 1、过程

 - 服务端向CA提供自己的公钥、签署名等相关信息。
 - CA将这些信息处理后形成**数字证书**给服务端，现在，服务端相当于在CA注册过了。
 - 客户端需要服务端的公钥时，拿着服务端提供的数字证书去CA认证
 - 在CA认证通过，说明证书可信，就**从证书里面拿到公钥**，进行后续操作。



### 2、CA中发生的流程



#### 证书-获得

服务器提供公钥+签署名等信息 给 CA 。

CA通过一个散列算法处理这些信息，得到 摘要。**（明文散列→ 摘要）**

CA用自己的 私钥加密摘要 ， 得到 数字签名。 **（摘要 + CA公钥 → 数字签名）**

将 **散列算法 + 摘要 + 服务器提供的信息 + 数字签名** 整合，得到证书 给服务端。



#### 证书-验证

客户端 **从服务端拿到证书，去CA认证**：

用CA的公钥解密数字签名 得到 摘要

用证书里指定的散列算法处理证书中的明文信息，得到摘要B

比较 摘要B == 证书里的摘要 ？证书是合理的，里面的公钥可用 ： 有问题。





### 3、CA可靠性

​	CA和浏览器和操作系统厂商合作，一开始就内嵌CA自己的公钥进去，一定程度保证CA公钥可靠性。



## 中间人攻击 

​	在没有CA的情况下，存在第三方拦截问题。

![img](https://upload-images.jianshu.io/upload_images/8525388-4e5ffd442371baee.png?imageMogr2/auto-orient/strip|imageView2/2/w/1134/format/webp)







